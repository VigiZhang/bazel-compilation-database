From 21ffb2ac967f968eed5078ccbfb46ccf186e0eee Mon Sep 17 00:00:00 2001
From: Longwu Ou <xulongwu4@gmail.com>
Date: Sun, 24 Nov 2019 14:51:45 -0500
Subject: [PATCH] Correct build of extract_compile_command

---
 .../generate_compile_commands/extract_compile_command.cc      | 4 ++--
 tools/build_rules/external_tools/external_tools_configure.bzl | 1 -
 2 files changed, 2 insertions(+), 3 deletions(-)

diff --git a/kythe/cxx/tools/generate_compile_commands/extract_compile_command.cc b/kythe/cxx/tools/generate_compile_commands/extract_compile_command.cc
index fd2f8a44..804b54e4 100644
--- a/kythe/cxx/tools/generate_compile_commands/extract_compile_command.cc
+++ b/kythe/cxx/tools/generate_compile_commands/extract_compile_command.cc
@@ -73,10 +73,10 @@ std::string GetBuildDirectory() {
     char cwd[MAXPATHLEN];
     build_dir = getcwd(cwd, MAXPATHLEN);
   }
-  auto sandbox_start = build_dir.find("/bazel-sandbox/");
+  auto sandbox_start = build_dir.find("/sandbox/linux-sandbox/");
   if (sandbox_start == std::string::npos) return build_dir;
   auto sandbox_end =
-      build_dir.find("/", sandbox_start + strlen("/bazel-sandbox/"));
+      build_dir.find("/", sandbox_start + strlen("/sandbox/linux-sandbox/"));
 
   return build_dir.erase(sandbox_start, sandbox_end - sandbox_start);
 }
diff --git a/tools/build_rules/external_tools/external_tools_configure.bzl b/tools/build_rules/external_tools/external_tools_configure.bzl
index 7fb88632..6ef07922 100644
--- a/tools/build_rules/external_tools/external_tools_configure.bzl
+++ b/tools/build_rules/external_tools/external_tools_configure.bzl
@@ -45,7 +45,6 @@ def _external_toolchain_autoconf_impl(repository_ctx):
         "readlink",
         "rm",
         "sed",
-        "source-highlight",
         "tee",
         "touch",
         "zip",
-- 
2.24.0

